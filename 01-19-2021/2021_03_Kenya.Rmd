---
title: "Tidy Tuesday (01-19-2021) - Kenya Census"
author: "Tim Gordon"
date: "January 24, 2021"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(cache=TRUE, warning=FALSE,
                      message=FALSE, echo = TRUE, dpi=180,
                      fig.width = 9, fig.height = 6)
library(tidyverse)
library(skimr)
library(ggplot2)
library(tidytext)
library(dplyr)
```



```{r cars}
gender <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-19/gender.csv')
crops <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-19/crops.csv')
household <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-19/households.csv')
```



```{r gender}
gender %>%
  filter(County != "Total") %>%
  select(!Total) %>%
  pivot_longer(!County, names_to="gender", values_to="pop") %>%
  mutate(gender = factor(gender, levels = c("Male","Female", "Intersex"))) %>%
  ggplot(aes(x=pop, y=County, fill=gender)) +
  geom_bar(stat="identity", position="fill", colour="black") +
  scale_x_continuous() + 
  theme_bw() +
  labs(title="Gender distribution across different Kenyan Counties",
       x="Population Distribution",
       y="County")

```

```{r crops}
crops %>%
  pivot_longer(!SubCounty, names_to="Crops", values_to="Count") %>%
  filter(SubCounty != "KENYA") %>%
  mutate(Count = replace_na(Count, 0)) %>%
  mutate(Type = case_when(
    Crops %in% c("Cashew Nut", "Coconut", "Macadamia") ~ "Nut",
    Crops %in% c("Coffee", "Tea", "Khat(Miraa)") ~ "Plant",
    Crops == "Farming" ~ "Farming",
    TRUE ~ "Fruit")) %>%
  ggplot(aes(x=SubCounty, y=Count, fill=Crops)) +
  geom_bar(stat="identity", color="black")+
  scale_y_continuous() +
  facet_grid(Type ~ .) +
  theme_grey() + 
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title="Crop Coverage through Kenyan Counties",
       x="County",
       y="Count")
```

